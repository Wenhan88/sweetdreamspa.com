<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin - Manage Reviews</title>
<link rel="stylesheet" href="style.css">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="js/firebase.js"></script>
</head>
<body>
<header><h1>Admin Panel</h1></header>
<div class="container">
<div id="loginDiv">
    <input type="email" id="email" value="shiwenhan0525@gmail.com" placeholder="Email">
    <input type="password" id="password" value="Wenhan0512" placeholder="Password">
    <button onclick="login()">Login</button>
</div>

<div id="adminPanel" style="display:none;">
    <h2>Reviews</h2>
    <div id="reviewsList"></div>
    <button onclick="logout()">Logout</button>
</div>
</div>
<script>
function login(){
    const email=document.getElementById('email').value;
    const password=document.getElementById('password').value;
    auth.signInWithEmailAndPassword(email,password)
    .then(()=>{ document.getElementById('loginDiv').style.display='none'; document.getElementById('adminPanel').style.display='block'; loadReviews(); })
    .catch(err=>alert(err.message));
}
function logout(){ auth.signOut().then(()=>{ document.getElementById('loginDiv').style.display='block'; document.getElementById('adminPanel').style.display='none'; }); }

function loadReviews(){
    db.collection('reviews').orderBy('rating','desc').onSnapshot(snapshot=>{
        const reviewsDiv=document.getElementById('reviewsList');
        reviewsDiv.innerHTML='';
        snapshot.forEach(doc=>{
            const data=doc.data();
            const div=document.createElement('div');
            div.style.border="1px solid #ccc";
            div.style.margin="5px";
            div.style.padding="5px";
            div.innerHTML=`<strong>${data.name} (${data.rating}â˜…)</strong><p>${data.comment}</p >
            <button onclick="deleteReview('${doc.id}')">Delete</button>`;
            reviewsDiv.appendChild(div);
        });
    });
}
function deleteReview(docId){
    if(confirm('Are you sure you want to delete this review?')){
        db.collection('reviews').doc(docId).delete()
        .then(()=>alert('Deleted!'))
        .catch(err=>alert(err.message));
    }
}
</script>
</body>
</html>
